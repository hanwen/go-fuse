{
  "comments": [
    {
      "key": {
        "uuid": "ca753715_e8ca7901",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1017031
      },
      "writtenOn": "2019-09-09T12:07:26Z",
      "side": 1,
      "message": "The check for EUID\u003d0 is actually not needed. /dev/fuse is usually readable-writable for _all_ users and it is sys.Mount that is usually failing with EPERM for non-root. However since we anyway fallback on using /bin/fusermount if any of open(/dev/fuse) or sys_mount fails, imho it is better to drop the `if EUID\u003d\u003d0` check and just see what kernel gives us.",
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "53e662e9_3c51ff14",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1017030
      },
      "writtenOn": "2019-09-09T14:29:20Z",
      "side": 1,
      "message": "sounds good, I think we can indeed drop the check thanks to the fallback",
      "parentUuid": "ca753715_e8ca7901",
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dc7bddb1_0b74c272",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 34,
      "author": {
        "id": 1007980
      },
      "writtenOn": "2019-09-09T12:08:03Z",
      "side": 1,
      "message": "should this be optional? IIRC, you don\u0027t get an updated mtab if you use a syscall. Does \u0027mount\u0027 should mounts created in this way?",
      "range": {
        "startLine": 33,
        "startChar": 23,
        "endLine": 34,
        "endChar": 57
      },
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "246326da_5606ab37",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 34,
      "author": {
        "id": 1017030
      },
      "writtenOn": "2019-09-09T14:29:20Z",
      "side": 1,
      "message": "I believe many linux distros nowaday /etc/mtab is a symlink to /proc/self/mounts so updating mtab isn\u0027t really a requirement in those cases, but some users may still prefer having this go through mount and update /etc/mtab. fusermount has some code checking if /etc/mtab is a symlink or not, and will update the file if not. We can either implement something similar, or decide against it and make this an optional feature for people with symlinks and/or embedded systems.",
      "parentUuid": "dc7bddb1_0b74c272",
      "range": {
        "startLine": 33,
        "startChar": 23,
        "endLine": 34,
        "endChar": 57
      },
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2769120_5a4b4bc6",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1007980
      },
      "writtenOn": "2019-09-09T12:08:03Z",
      "side": 1,
      "message": "shouldn\u0027t this close the ready chan?\n\ncan you put this in a separate function (maybe create mountSyscall, mountFusermount), so that you can share relevant bits.",
      "range": {
        "startLine": 57,
        "startChar": 11,
        "endLine": 57,
        "endChar": 13
      },
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a3ea1fad_d0f44524",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1017030
      },
      "writtenOn": "2019-09-09T14:29:20Z",
      "side": 1,
      "message": "Indeed, you\u0027re right. And yes, this code could be moved to its own method, I\u0027ll submit a modified version",
      "parentUuid": "c2769120_5a4b4bc6",
      "range": {
        "startLine": 57,
        "startChar": 11,
        "endLine": 57,
        "endChar": 13
      },
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "52f2903a_b1d110ec",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 112,
      "author": {
        "id": 1007980
      },
      "writtenOn": "2019-09-09T12:08:03Z",
      "side": 1,
      "message": "should this be done for your syscall thing too?",
      "range": {
        "startLine": 112,
        "startChar": 9,
        "endLine": 112,
        "endChar": 20
      },
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c94d7dcf_ba0eefb0",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 112,
      "author": {
        "id": 1017030
      },
      "writtenOn": "2019-09-09T14:29:20Z",
      "side": 1,
      "message": "syscall.Open sets close on exec on the fd by default, so not needed afaik",
      "parentUuid": "52f2903a_b1d110ec",
      "range": {
        "startLine": 112,
        "startChar": 9,
        "endLine": 112,
        "endChar": 20
      },
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e22caa13_38b339db",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1017031
      },
      "writtenOn": "2019-09-09T12:07:26Z",
      "side": 1,
      "message": "We can do here similarly. Just try sys_umount, and if it is EPERM fallback to /bin/fusermount.",
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80ddd939_d99c7ecf",
        "filename": "fuse/mount_linux.go",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1017030
      },
      "writtenOn": "2019-09-09T14:29:20Z",
      "side": 1,
      "message": "indeed, unless we make this whole process optional (for update of /etc/mtab) but in that case we will need to be able to access mount options during unmount. It\u0027s probably possible from where unmount() is called, I\u0027ll have a look and submit a new version with all those changes.",
      "parentUuid": "e22caa13_38b339db",
      "revId": "c909554950e7bec0fd6d2bff35aaba80b5704a25",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    }
  ]
}